{#if isVisible}
<div class="debug">
    <button on:click="simulateTracking()">random tracking</button>
    <button on:click="noTrackingInfo()">no tracking info</button>
    <button on:click="fire('clear')">clear</button>
    <button on:click="modifySection()">modify</button>
    <br>
    <input type="text" bind:value=inputValue>
</div>
{/if}

<style>
  .debug {
    padding: 10px;
  }
</style>

<script>
  import Livechat from '@livechat/agent-app-widget-sdk';
  
  export default {
    data() {
      return {
        hostname: 'https://XXXXX.ngrok.io',
        inputValue: ''
      };
    },

    methods: {
      modifySection() {
        const { inputValue } = this.get();
        let parsed = JSON.parse(inputValue);
        parsed = Array.isArray(parsed) ? parsed : [parsed];
        console.log(parsed);
        Livechat.modifyCustomerDetailsSection({
          title: "UPS Delivery Status",
          components: parsed
        });
      },

      simulateTracking() {
        function getRandomInt(min, max) {
          return Math.floor(Math.random() * (max - min + 1) + min);
        }
  
        const debugTrackingNumbers = ['1Z648616E192760718', '1ZWX0692YP40636269', '1Z12345E1305277940', '1Z12345E1505270452', '1Z12345E0205271688'];
        const { handleCustomerMessage } = this.get();
        const random1 = debugTrackingNumbers[getRandomInt(2, debugTrackingNumbers.length - 1)];
        const random2 = debugTrackingNumbers[getRandomInt(0, 2)];
        const message = `foo bar ${random1} bar bar foo ${random2}`;

        this.fire('loadTrackingNumber', { 
          message,
          message_source: 'visitor',
          chat: this.get().chat
        });
      },

      noTrackingInfo() {
        this.fire('loadTrackingNumber', { 
          message: '1Z12345E1505270452',
          message_source: 'visitor',
          chat: this.get().chat
        });
      }
    }
  }
</script>