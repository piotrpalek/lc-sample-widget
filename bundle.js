!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e){t.exports=function(...t){let e=t[0];for(let n=1,r=t.length;n<r;n++)e=t[n](e);return e}},function(t,e){t.exports=(t=>e=>(n,r)=>{0===n&&e(0,(e,n)=>{r(e,1===e?t(n):n)})})},function(t,e){t.exports=(t=>e=>(n,r)=>{if(0!==n)return;let o;e(0,(e,n)=>{0===e?(o=n,r(e,n)):1===e?t(n)?r(e,n):o(1):r(e,n)})})},function(t,e){t.exports=(t=>e=>{let n;e(0,(e,r)=>{0===e&&(n=r),1===e&&t(r),1!==e&&0!==e||n(1)})})},function(t,e){t.exports=(t=>e=>(n,r)=>{if(0!==n)return;let o,i=0;function a(e,n){i<t&&o(e,n)}e(0,(e,n)=>{0===e?(o=n,r(0,a)):1===e?i<t&&(i++,r(e,n),i===t&&(r(2),o(2))):r(e,n)})})},function(t,e){t.exports=function(){let t=[];return(e,n)=>{if(0===e){const e=n;t.push(e),e(0,n=>{if(2===n){const n=t.indexOf(e);n>-1&&t.splice(n,1)}})}else{const r=t.slice(0);for(let o,i=0,a=r.length;i<a;i++)o=r[i],t.indexOf(o)>-1&&o(e,n)}}}},function(t,e,n){t.exports=n(8)},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r=function(t){return t=t||Object.create(null),{on:function(e,n){(t[e]||(t[e]=[])).push(n)},off:function(e,n){t[e]&&t[e].splice(t[e].indexOf(n)>>>0,1)},emit:function(e,n){(t[e]||[]).slice().map(function(t){t(n)}),(t["*"]||[]).slice().map(function(t){t(e,n)})}}};var o=t=>(e,n)=>{if(0!==e)return;const r=t=>void 0!==t,o=t=>void 0===t;let i,a,s=!1;function u(t,e){1===t&&(a||i)(1,e),2===t&&(a&&a(2),i&&i(2))}t(0,(t,e)=>{if(0===t)i=e,n(0,u);else if(1===t){const t=e;a&&a(2),t(0,(t,e)=>{0===t?(a=e)(1):1===t?n(1,e):2===t&&o(e)?s?n(2):(a=void 0,i(1)):2===t&&r(e)&&n(2,e)})}else 2===t&&o(e)?a?s=!0:n(2):2===t&&r(e)&&n(2,e)})},i=n(1),a=n.n(i);var s={}.hasOwnProperty;function u(t,e){return s.call(e,t)}Array.isArray,"function"==typeof Symbol&&Symbol.iterator,Object.assign;function c(){return Math.random().toString(36).substring(2)}var f=t=>(e,n)=>{if(0===e){let e=!1;n(0,t=>{2===t&&(e=!0)}),n(1,t()),e||n(2)}};var l=function(t){return o(f(t))},d=n(2),h=n.n(d),p=n(0),v=n.n(p),m=n(4),g=n.n(m);var _=function(t){return function(e,n){if(0===e){var r=!1;n(0,function(t){2===t&&(r=!0)}),r||n(2,t||new Error)}}};var y=function(t){return function(e,n){if(0===e){var r,o,i=!1,a=!1;t(0,function(t,e){return 0===t?(r=e,void n(0,function(t,e){2===t&&(a=!0),r(t,e)})):1===t?(i=!0,o=e,void r(1)):void(2===t&&!e&&i&&(n(1,o),a)||n(t,e))})}}};var b=(t={})=>e=>{"function"==typeof t&&(t={next:t});let n,{next:r,error:o,complete:i}=t;return e(0,(t,e)=>{0===t&&(n=e),1===t&&r&&r(e),1!==t&&0!==t||n(1),2===t&&!e&&i&&i(),2===t&&e&&o&&o(e)}),()=>{n&&n(2)}};var w=function(t){return new Promise(function(e,n){b({next:e,error:n,complete:function(){var t=new Error("No elements in sequence.");t.code="NO_ELEMENTS",n(t)}})(y(t))})},O=function(t){return new Promise(function(e){e(t())})},M=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},k=function(){var t={},e=r(t);return M({},e,{off:function(n,r){n?e.off(n,r):Object.keys(t).forEach(function(e){delete t[e]})},once:function(t,n){e.on(t,function r(o){e.off(t,r),n(o)})}})};var S=(t,e,n)=>(r,o)=>{if(0!==r)return;let i=!1;const a=t=>{o(1,t)};o(0,r=>{2===r&&(i=!0,t.removeEventListener(e,a,n))}),i||t.addEventListener(e,a,n)},x=n(3),E=n.n(x);var j=t=>{let e,n=[];return function(r,o){if(0!==r)return;n.push(o);const i=(t,r)=>{if(2===t){const t=n.indexOf(o);t>-1&&n.splice(t,1),n.length||e(2)}else e(t,r)};1!==n.length?o(0,i):t(0,(t,r)=>{if(0===t)e=r,o(0,i);else for(let e of n.slice(0))e(t,r);2===t&&(n=[])})}};n(5);var T=function(t){return function(e){return function(n,r){if(0===n){var o,i,a=t instanceof Date;e(0,function(e,n){if(0===e)return o=n,s(a?t-Date.now():t),void r(0,function(t,e){2===t&&clearTimeout(i),o(t,e)});2===e?clearTimeout(i):1!==e||a||(clearTimeout(i),s(t)),r(e,n)})}function s(t){i=setTimeout(function(){o(2);var t=new Error("Timeout.");t.code="TIMEOUT",r(2,t)},t)}}}};var C="handshake",P="response";function N(t){return function(e){return o(a()(t)(e))}}var D=0,A=function(t,e,n){return l(function(){var r=D++;return n.request=r,e(n),v()(t,h()(function(t){return t.type===P&&t.request===r}),N(function(t){if(!t.data.error)return f(function(){return t.data.result});var e=t.data.result,n=e.real,r=e.error;if(!n)return _(r);var o=new Error(r.message);return u("code",r)&&(o.code=r.code),_(o)}),g()(1))})},B=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},I=function(t,e,n,r){return B({},t,{call:function(t){for(var o=arguments.length,i=Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return v()(A(e,r,n("call",{method:t,args:i})),w)},emit:function(t,e){r(n("emit",{event:t,arg:e}))}})},L=function(t,e,n,r){var o;return(o={})["@@livechat/postmessenger"]=!0,o.owner=t,o.instance=e,o.type=n,o.data=r,o},z=function(t,e,n,r){return function(o){switch(o.type){case"call":return void O(function(){var e=o.data,n=e.method,i=e.args;return r[n].apply(t,i)}).then(function(t){o.type=P,o.data={error:!1,result:t},n(o)},function(t){o.type=P;var e=void 0;t instanceof Error?(e={real:!0,error:{message:t.message}},u("code",t)&&(e.error.code=t.code)):e={real:!1,error:t},o.data={error:!0,result:e},n(o)});case"emit":var i=o.data,a=i.event,s=i.arg;return void e(a,s);default:return}}},J=function(t){return e=function(t){return"function"==typeof t},n=t,Object.keys(n).reduce(function(t,r){return t[e(n[r])?0:1][r]=n[r],t},[{},{}]);var e,n},U=function(t){return!!t.data&&t.data["@@livechat/postmessenger"]},Y=c();v()(S(window,"message"),h()(function(t){return U(t)&&t.data.owner===Y}),a()(function(t){return t.data}),j);var q=v()(S(window,"message"),h()(U),a()(function(t){return t.data.origin=t.origin,t.data}),j);function W(){return(W=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var K=function(t){var e=location.search.replace(/^\?/,"").split("&").map(function(t){return t.split("=").map(decodeURIComponent)}).reduce(function(t,e){var n=e[0],r=e[1];return t[n]=r,t},{});return void 0!==e[t]?e[t]:null},R=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce(function(t,e){return e(t)},t)}};function $(t){var e,n=t.handleMessage,r=K("plugin_id"),o="plain"===K("connection"),i=function(t){return W({},t,{plugin_id:r})};return o?Promise.resolve((e={"http://my.lc:3000":!0,"https://my.labs.livechatinc.com":!0,"https://my.staging.livechatinc.com":!0,"https://my.livechatinc.com":!0},window.addEventListener("message",function(t){(function(t){return!0===e[t.origin]})(t)&&n(t.data)}),{send:function(t){return parent.postMessage(i(t),"*"),Promise.resolve()}})):function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=J(t),n=e[0],r=e[1],o=window.parent,i=void 0,s=void 0,u=void 0,c=k(),f=function(t){o.postMessage(t,i)},l=I(c,q,function(t,e){return L(s,u,t,e)},f),d=v()(q,h()(function(t){return t.type===C}),T(3e3),g()(1),j);v()(d,E()(function(t){i=t.origin,s=t.owner,u=t.instance})),v()(d,E()(function(t){f(B({},t,{type:P,data:{error:!1,result:r}}))}));var p=z(l,c.emit,f,n);return v()(d,N(function(){return q}),E()(p)),{promise:v()(d,a()(function(t){return l.data=t.data,l}),w)}}({handle:n}).promise.then(function(t){return{send:function(e){return t.call("handle",i(e)).then(function(){})}}})}var F={button:!0,label_value:!0,title:!0,link:!0,line:!0},G=function(t){return W({},t)};function H(t){function e(t){throw new Error(t)}t&&t.type||e("You must supply a component definition with a 'type' property");var n=t.type,r=t.data;switch(!0!==F[n]&&e("'"+n+"' is not a valid component type"),n){case"button":r&&r.label||e("The button component must have a 'label' property"),r.id||e("The button component must have a 'id' property");break;case"link":r&&r.url||e("The link component must have a 'url' property");break;case"title":r&&r.title||e("The title component must have a 'title' property"),void 0!==r.imgSize&&("small"===r.imgSize&&"big"===r.imgSize||e("The title component must have a valid 'imgSize' property, allowed values are 'small' and 'big'"))}return t}var Q,V,X,Z,tt,et,nt,rt=(Z=!1,tt=r(),et=function(t){var e=t.eventEmitter;return function(t){if(t&&t.event_name)switch(t.event_name){case"livechat:customer_profile":e.emit("customer_profile",t.event_data);break;case"livechat:customer_profile_hidden":e.emit("customer_profile_hidden",t.event_data);break;case"livechat:message":e.emit("message",t.event_data);break;case"livechat:customer_details_section_button_click":e.emit("customer_details_section_button_click",t.event_data)}}}({eventEmitter:tt}),X=R(G,H),nt=function(t){return t.map(X)},{init:function(){return V||(V=this._sendMessage("plugin_inited").then(function(){Z=!0})),V},on:tt.on,off:tt.off,track:function(t,e){return void 0===t&&(t=""),void 0===e&&(e={}),"string"==typeof t&&"object"==typeof e&&this._sendMessage("track",{event_name:t,event_properties:e})},refreshSessionId:function(){return this._sendMessage("plugin_loaded")},getSessionId:function(){return null},putMessage:function(t){return this._sendMessage("put_message",t)},watchMessages:function(){return this._sendMessage("watch_messages")},modifyCustomerDetailsSection:function(t){if(!t)throw new Error("You need to provide a section defintion");var e=t.title,n=t.imgUrl,r=t.components;if(!e)throw new Error("You need to provide a title for the new section using the 'title' property");if(!Array.isArray(r)||!r.length)throw new Error("You need to provide an array of component definitions for your section using the 'components' property");return this._sendMessage("customer_details_section",{title:e,imgUrl:n,components:nt(r)})},_sendMessage:function(t,e){if(void 0===e&&(e=null),"plugin_inited"!==t&&!Z)throw new Error("Before any operation you must initialize the SDK using the `init` method and wait for it to resolve");return(Q?Promise.resolve(Q):$({handleMessage:et}).then(function(t){return Q=t})).then(function(n){n.send({message:t,data:e})})}});function ot(){}function it(t,e){for(var n in e)t[n]=e[n];return t}function at(t,e){for(var n in e)t[n]=1;return t}function st(t){t()}function ut(t,e){t.appendChild(e)}function ct(t){return document.createElement(t)}function ft(t){return document.createTextNode(t)}function lt(){return Object.create(null)}function dt(t){this.destroy=ot,this.fire("destroy"),this.set=ot,this._fragment.d(!1!==t),this._fragment=null,this._state={}}function ht(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function pt(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var r=0;r<n.length;r+=1){var o=n[r];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}}function vt(t){t._lock=!0,wt(t._beforecreate),wt(t._oncreate),wt(t._aftercreate),t._lock=!1}function mt(){return this._state}function gt(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}}function _t(t){this._set(it({},t)),this.root._lock||vt(this.root)}function yt(t){var e=this._state,n={},r=!1;for(var o in t=it(this._staged,t),this._staged={},t)this._differs(t[o],e[o])&&(n[o]=r=!0);r&&(this._state=it(it({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))}function bt(t){it(this._staged,t)}function wt(t){for(;t&&t.length;)t.shift()()}function Ot(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)}var Mt={destroy:dt,get:mt,fire:pt,on:gt,set:_t,_recompute:ot,_set:yt,_stage:bt,_mount:Ot,_differs:ht},kt=JSON.stringify({title:"Widget Integration",components:[{type:"button",data:{label:"Sample button",id:"section-button"}}]});n(7);var St={async handleButtonClickMessage({buttonId:t}){const{counter:e}=this.get(),n=e+1,r=JSON.parse(kt);r.components[0].data.label=`Sample: ${n}`,await rt.modifyCustomerDetailsSection(r),this.set({counter:n})},resetWidget(){const t=JSON.parse(kt);console.log(rt.modifyCustomerDetailsSection(t)),this.set({buttonMessage:"Done!"}),setTimeout(()=>this.set({buttonMessage:"Click to reset widget",counter:0}),500)}};function xt(){rt.off("customer_details_section_button_click",this.handleButtonClickMessage)}function Et(t){!function(t,e){t._handlers=lt(),t._slots=lt(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}(this,t),this._state=it({counter:0,buttonMessage:"Click to reset widget"},t.data),this._intro=!!t.intro,this._handlers.destroy=[xt],this._fragment=function(t,e){var n,r,o,i,a,s;function u(e){t.resetWidget()}return{c(){var t,s,c;n=ct("div"),(r=ct("h1")).textContent="Example App",o=ft("\n\t\t"),i=ct("button"),a=ft(e.buttonMessage),t="click",s=u,i.addEventListener(t,s,c),i.className="svelte-vgbsx1",n.className="main"},m(t,e){!function(t,e,n){t.insertBefore(e,n)}(t,n,e),ut(n,r),ut(n,o),ut(n,i),ut(i,a),s=!0},p(t,e){var n,r;t.buttonMessage&&(n=a,r=e.buttonMessage,n.data=""+r)},i(t,e){s||this.m(t,e)},o:st,d(t){var e;t&&(e=n).parentNode.removeChild(e),function(t,e,n,r){t.removeEventListener(e,n,r)}(i,"click",u)}}}(this,this._state),this.root._oncreate.push(()=>{(function(){this.handleButtonClickMessage=this.handleButtonClickMessage.bind(this),rt.on("customer_details_section_button_click",this.handleButtonClickMessage)}).call(this),this.fire("update",{changed:at({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),vt(this)),this._intro=!0}it(Et.prototype,Mt),it(Et.prototype,St);var jt=Et;!async function(){await rt.init(),await rt.modifyCustomerDetailsSection(JSON.parse(kt));const t=new jt({target:document.body});window.app=t}()}]);